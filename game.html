<html>
    <canvas id="canvas">

    </canvas>
    <script>
        let canvas = document.getElementById("canvas");
        let context = canvas.getContext('2d');
        let width = canvas.width = 800;
        let height = canvas.height = 600;
        let ballX = 400;
        let ballY = 300;
     
        const FPS = 1000 / 30;
        let velX = 10;
        let velY = 10;
      
        let ballRad = 10;
        let paddleWidth = 20;
        let paddleHeight = 100;
        let lPaddleY = 300;
        let rPaddleY = 300;
        let lPaddleX = 25;
        let rPaddleX = 755;
        let lScore = 0;
        let rScore = 0;
        let mX = canvas.width / 2 - paddleWidth / 2;
        let mY = 300;
        let velM = 5;

        function moveBall(){
            ballX += velX;
            ballY += velY;
            if(ballX > 800 || ballX < 0 )velX *= -1;
            if(ballY > 600 || ballY < 0)velY *= -1;
            if(ballX < 0) {rScore ++;
            console.log ("Computer: " + rScore);
            start();
            }
            if(ballX > 800){ lScore ++;
            console.log("Player: " + lScore);
            start();
            }
           
           
           //is the ball touching the left paddle?
            if(ballY < lPaddleY + paddleHeight && ballY > lPaddleY && ballX > lPaddleX && ballX < lPaddleX + paddleWidth){
            velX *= -1;
            ballX = lPaddleX + paddleWidth + 1;
            }
          //is the ball touching the right paddle?
          if(ballY < rPaddleY + paddleHeight && ballY > rPaddleY && ballX > rPaddleX && ballX < rPaddleX + paddleWidth){
            velX *= -1;
            ballX = rPaddleX - 1;
           }
           if(ballY < mY + paddleHeight && ballY > mY && ballX > canvas.width / 2 - paddleWidth / 2 && ballX < canvas.width / 2 + paddleWidth / 2){
            velX *= -1;
            if(velX = -10) ballX = canvas.width / 2 - paddleWidth / 2 - 1;
            if(velX = 10) ballX = canvas.width / 2 + paddleWidth / 2 + 1
           }
           
            }
             
        
        

        
        function drawRect(startX, startY, width, height, color){
            context.fillStyle = color;
             context.fillRect(startX, startY, width, height);
        }

        function drawCircle(centerX, centerY, Radius, color){
            context.fillStyle = color;
            context.beginPath();
            context.arc(centerX, centerY, Radius, 0, Math.PI * 2, true);
            context.fill();

        }

        function updateAll(){
            moveBall();
            drawRect(0, 0, width, height, 'green');
            drawRect((width/2) - 10, 5, 20, 590, 'white');
            drawRect(755, rPaddleY, paddleWidth, paddleHeight, 'red');
            drawRect(25, lPaddleY, paddleWidth, paddleHeight, 'blue');
            drawCircle(ballX, ballY, ballRad, 'rgb(151, 191, 36)');
            centerPaddleMove();
            rPaddleMove();
            scoring();
            
        }


        function calculateMousePosition(event){
            let rect = canvas.getBoundingClientRect(), root = document.documentElement;

            let mouseX = event.clientX - rect.left - root.scrollLeft;
            let mouseY = event.clientY - rect.top - root.scrollTop;

            return{
                x: mouseX,
                y: mouseY
            };
        }
        
        window.onload = function(){
            console.log(canvas);
                setInterval(function(){
                   updateAll();
                }, FPS);
        

                canvas.addEventListener('mousemove', function(event){
                        let mousePos = calculateMousePosition(event);  
                        lPaddleY = mousePos.y - paddleHeight / 2;  
                        if(lPaddleY > 600 - paddleHeight){     
                            lPaddleY = 600 - paddleHeight;
                        }     
                        if(lPaddleY < 0){
                            lPaddleY = 0;
                        }        
                })
        }

       function rPaddleMove(){
          
           if(rPaddleY + paddleHeight / 2 < ballY){
               rPaddleY += 9;
           }
           if (rPaddleY + paddleHeight / 2 > ballY){
               rPaddleY -= 9;
           }
           if(rPaddleY< 0){
               rPaddleY = 0;
           }
           if (rPaddleY > 600 - paddleHeight){
               rPaddleY = 600 - paddleHeight;
           }
          
           if (paddleHeight < 10) paddleHeight = 10; 
           }
       

        function start(){
            ballX = canvas.width / 2;
            ballY = canvas.height / 2;
           
            rPaddleY = canvas.height / 2;
            paddleHeight -= 1;
            

        }
           
        function scoring(){
            if(lScore >= 50){
                console.log("Player wins!")
                lScore = 0;
                rScore = 0;
                paddleHeight = 101;
                start();

            }
            if(rScore >= 50){
                console.log("Computer wins!")
                lScore = 0;
                rScore = 0;
                paddleHeight = 101
                start();

            }
                 
        }
       
        
        function centerPaddleMove(){
            mY += velM;
            drawRect(canvas.width / 2 - paddleWidth / 2, mY, paddleWidth, paddleHeight, 'black');
            if(mY < 0 || mY > canvas.height - paddleHeight){
                velM *= -1;
                
            }

        }

        

        

        
       
    </script>

</html>